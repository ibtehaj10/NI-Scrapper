from slack_sdk import WebClient
from slack_sdk.errors import SlackApiError
import requests
import json
import time
# Your Slack bot token
slack_token = ""
client = WebClient(token=slack_token)

# The channel ID or name where you want to send the message
channel_id = ""


def scraping():
    import requests
    import json
    
    url = "http://127.0.0.1:8000/wallet-info/"
    
    payload = json.dumps({
      "wallet_name": "ni",
      "width": 200,
      "sort_by": "VTRUST"
    })
    headers = {
      'Content-Type': 'application/json'
    }

    response = requests.request("POST", url, headers=headers, data=payload)
    return response



# try:
    # Call the chat.postMessage method using the WebClient
while True:
    scrape = scraping().text
    print(scrape)
    result = client.chat_postMessage(
        channel=channel_id,
        text=scrape
    )
    print(f"Message sent successfully, ts: {result['ts']}")
    time.sleep(3600)
